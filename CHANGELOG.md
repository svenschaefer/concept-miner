# Changelog

All notable changes to this project are documented in this file.

## [Unreleased]

- No unreleased changes.

## [1.0.1] - 2026-02-17

- release packaging guard:
  - reaffirmed that `prototype/` is excluded from npm package payloads.
  - added explicit ignore hardening (`.npmignore`, `.gitignore`) and release docs notes.
- release correction:
  - supersedes `1.0.0` for consumers due to packaging-policy correction.
  - published to npmjs with `latest` dist-tag updated to `1.0.1`.
  - deprecation of `1.0.0` is pending npm 2FA confirmation.

## [1.0.0] - 2026-02-17

- v0.102 product runtime decoupling:
  - removed runtime bridge import path to `prototype/*` (`src/core/prototype-bridge.js` removed)
  - `extractConcepts` now uses product-native extraction paths for seed runtime and Step12 inputs
  - integration contract now enforces that product runtime does not load `prototype/*` modules.
- v0.001 scaffold baseline integrated with template structure, scripts, and quality gates.
- v0.003 transition product API added: `extractConcepts` and `validateConcepts`.
- v0.004 product CLI commands added: `extract` and `validate-concepts` (compatibility commands retained).
- v0.004 contract guard tests added for OpenAPI/schema endpoint and field alignment.
- v0.005 realistic artifact corpus layout contract test added.
- v0.006 prototype benchmark/legacy policy checks enforced in `ci:check`.
- v0.007 frozen persisted-mode reference regression test added across realistic seeds.
- v0.008 README updated with current runnable API/CLI usage.
- v0.009 local `release:check` gate validated as green.
- v0.010-a frozen reference policy guard added (`check:frozen-references-policy`) with CI enforcement.
- v0.010-b OpenAPI alignment tightened:
  - `ExtractConceptsResponse` now requires `schema_version` + `concepts`
  - `input_id` minLength constraints aligned with JSON schema
- v0.015 compatibility `validate` command now prioritizes canonical concepts-schema validation, with legacy template-output fallback retained during transition.
- v0.016 sidecar contracts added:
  - `schema/concept-candidates-meta.schema.json`
  - `schema/concept-candidates-diagnostics.schema.json`
  - integration checks validate frozen sidecars for all seeds/modes.
- v0.017 prototype tooling execution contracts added:
  - independent benchmark checks for `13a` and `13b` execution paths
  - threshold sweep report generation contract
  - wikipedia-title-index coverage report generation contract.
- v0.018 README now includes concrete REST quick-start examples for:
  - `POST /v1/concepts/extract`
  plus docs contract coverage to prevent regression.
- v0.019 documented Step12 upstream boundary in `docs/GUARANTEES.md`:
  - `elementary-assertions` ownership is explicit
  - in-scope vs out-of-scope behavior is now contract-tested in docs checks.
- v0.020 pre-1.0 tag strategy closed:
  - `docs/REPO_WORKFLOWS.md` documents `v0.x.y` annotated tag policy
  - clean `npm run release:check` verified before first annotated tag creation.
- v0.021 `TODO.md` truth-sync:
  - completed template/package/CLI/test/docs/CI checklist items marked done
  - remaining unchecked items narrowed to genuinely open engineering scope.
- v0.022 release workflow contract checks added:
  - validates tag/version consistency in `.github/workflows/release.yml`
  - validates npm tarball creation and artifact upload steps are present.
- v0.023 publish prerequisite and install-gate closure:
  - docs consistency checks enforce npm prerequisite guidance (`npm whoami`, `NPM_TOKEN`)
  - `npm ci` executed successfully and local quality gates re-verified.
- v0.024 post-productization documentation closure:
  - release notes published at `docs/releases/v0.10.0.md`
  - operational snapshot refreshed in `docs/STATUSQUO.md`
  - upstream backlog documented at `docs/STEP12_UPSTREAM_BACKLOG.md`.
- v0.025 operational/tooling closure:
  - optional PowerShell wrapper flows documented in `docs/OPERATIONAL.md`
  - integration contract added for `prototype/check-concept-candidates.js` execution.
- v0.026 generated report artifact governance:
  - checked-in snapshot policy documented in `docs/GENERATED_REPORT_ARTIFACTS_POLICY.md`
  - CI policy check added via `scripts/check-generated-report-artifacts-policy.js`.
- v0.027 prototype documentation migration:
  - contract/governance summary migrated into `docs/PROTOTYPE_MIGRATION_NOTES.md`
  - prototype TODO open/closed history mapped into product backlog context.
- v0.028 batch runner contract coverage:
  - added staged integration execution check for `prototype/run-seed-concept-candidates.ps1` in persisted mode.
- v0.029 TODO execution-order sync:
  - section-phase status now marks completed early phases (`Section 0`, `Sections 1-2`) explicitly.
- v0.030 prototype determinism/hard-failure coverage:
  - added hard-failure contract test for invalid `wiki_*_count` typing
  - added in-process and fresh-process replay determinism checks
  - added LF + single trailing newline serialization check for prototype CLI output.
- v0.031 contract docs synchronization:
  - added `docs/CONTRACT_ALIGNMENT.md` with canonical payload/no-envelope rule
  - synchronized `openapi/README.md` and `schema/README.md` with contract mapping
  - added contract-doc alignment checks in integration tests.
- v0.032 repository layout decision:
  - retained `prototype/` as in-repo historical/governance reference for current phase
  - documented in `docs/REPO_LAYOUT_DECISION.md`.
- v0.033 runtime-dependency guard migration:
  - product integration now enforces that runtime extraction paths do not depend on prototype/* modules.
- v0.034 concepts validation invariants:
  - `validateConcepts` now enforces duplicate concept-id rejection
  - `validateConcepts` now enforces duplicate concept-name rejection
  - `validateConcepts` now enforces occurrence bound validity (`end >= start`)
  - added unit contract tests for all three invariant classes.
- v0.035 concepts runtime modularization:
  - extracted fallback extraction helpers into `src/core/fallback-extraction.js`
  - extracted mode mapping helpers into `src/core/mode.js`.
  - extracted concept invariant checks into `src/validate/concepts-invariants.js`
  - simplified `src/concepts.js` to orchestration only.
- v0.036 CLI entrypoint contract hardening:
  - added `test/unit/cli-entrypoint.contract.test.js` to enforce thin `bin/cli.js` delegation
  - strengthened CLI usage contract test to keep compatibility commands (`run`, `validate`) visible.
- v0.037 compatibility alias contract closure:
  - added positive-path compatibility tests for `concept-miner run` and `concept-miner validate`
  - kept underscore and kebab-case mode compatibility contractually covered in CLI tests.
- v0.038 persisted candidate-schema migration:
  - added `schema/seed.concept-candidates.schema.json` as product-owned schema location
  - updated prototype generator/checker/tests to resolve the migrated schema first, with legacy fallback.
- v0.039 full golden artifact diff coverage:
  - added `test/integration/prototype-frozen-full-artifact.contract.test.js`
  - regenerates per-seed persisted artifacts and compares all frozen YAML/JSON outputs against `result-reference`
  - normalizes diagnostics `stats.phase_ms.*` timing values during comparison to avoid false drift from runtime timing variance.
- v0.040 core extraction invariant contracts:
  - added `test/integration/prototype-core-invariants.contract.test.js`
  - enforces canonicalization, deterministic concept-id derivation, role bucket non-negative integer counts, and wikipedia-title-index signal typing across realistic persisted Step12 seeds.
- v0.041 release smoke rehearsal closure:
  - added `scripts/release-smoke-rehearsal.js` and npm script `smoke:release:rehearsal`
  - executes prepublish and postpublish-style clean-workspace smoke installs against the local tarball
  - added script contract test `test/integration/release-smoke-rehearsal-script.contract.test.js`
  - updated `docs/NPM_RELEASE.md` with private-phase tarball-simulated postpublish flow and public-registry toggle.
- v0.042 determinism and ordering guard closure:
  - added `test/integration/prototype-repeat-determinism.contract.test.js`
  - enforces repeat-run deterministic persisted-step12 outputs across all realistic seeds and both modes
  - asserts byte-stable YAML/metadata and normalized diagnostics stability, plus object-level determinism validation.
- v0.043 runtime seed-path transition closure:
  - enforced product API runtime seed-path extraction compatibility for both legacy and flattened artifact layouts
  - added `test/integration/runtime-seed-path.contract.test.js` to enforce product API runtime seed-path extraction in both product modes.
- v0.104 schema export consolidation:
  - moved runtime/package schema export path to `schema/output.schema.json`
  - rewired runtime and package export references from `src/schema/output.schema.json`.
- v0.105 product schema hardening:
  - `concept.id` now enforces pattern `^(c_[0-9a-f]{12}|cc_[0-9a-f]{16})$`
  - `surface_forms` now enforces `uniqueItems: true`
  - OpenAPI/schema alignment checks extended for these constraints.
- v0.106 REST extract runtime implementation:
  - added in-repo HTTP server (`bin/api-server.js`, `src/server/http.js`)
  - exposed `POST /v1/concepts/extract` at runtime
  - added HTTP integration contracts for deterministic behavior and request validation.
- v0.107 internal mode terminology closure:
  - product runtime internals now normalize on product mode names (`generic-baseline`, `default-extended`)
  - seed artifact resolution prefers product-mode filenames first with legacy `13a`/`13b` fallback.
- v0.108 default-extended extension-field decision closure:
  - documented decision to defer broader schema-level extension block changes in this phase.
- v0.109 default-extended wikipedia runtime wiring:
  - default-extended runtime now queries `wikipedia-title-index` (`/v1/titles/query`) when reachable/configured
  - enrichment is exposed deterministically under `concepts[*].properties.wikipedia_title_index`
  - REST options added for runtime wiring:
    - `options.wikipedia_title_index_endpoint`
    - `options.wikipedia_title_index_timeout_ms`
  - added integration tests covering runtime lookup behavior and REST option passthrough.
- v0.110 default-extended contract formalization:
  - schema/OpenAPI/docs now explicitly type `concepts[*].properties.wikipedia_title_index`
  - required enrichment fields when present:
    - `exact_match` (`boolean`)
    - `prefix_count` (`integer`, `>= 0`)
  - added schema contract tests for valid/invalid enrichment typing.
- v0.111 REST/CLI runtime stabilization:
  - added CLI options:
    - `--wikipedia-title-index-endpoint`
    - `--wikipedia-title-index-timeout-ms`
  - documented and test-enforced deterministic fallback behavior when wikipedia-title-index is unavailable.
- v0.112 compatibility policy closure:
  - compatibility commands `run` and `validate` are explicitly retained as supported 1.x surfaces
  - docs consistency tests enforce the stated policy.
- v0.113 API runtime hardening:
  - added explicit request-size guard (1 MiB) and error mapping checks (`400`, `404`, `500`)
  - `createApiServer` now supports extractor injection for deterministic server error-path tests.
- v0.114 release/publish readiness closure:
  - documented current publish posture (`private: true`) in release docs
  - added initial `v1.0.0` release-notes checklist (finalized at `docs/releases/v1.0.0.md`)
  - revalidated smoke rehearsal flow for clean-workspace pre/post publish simulation.
- public npm release execution:
  - `concept-miner@1.0.0` published to npmjs
  - npm registry verification confirms `latest` dist-tag points to `1.0.0`.
